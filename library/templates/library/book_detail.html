{% extends 'library/base.html' %}

{% block title %}{{ book.title }} – Book Port{% endblock %}

{% block content %}
  <div class="card">
    <h2 class="page-title" style="margin-bottom:.2rem;">{{ book.title }}</h2>
    <div class="meta">by {{ book.author }}</div>

    {% if book.categories.exists %}
      <div class="badges" style="margin-top:.6rem;">
        {% for cat in book.categories.all %}
          <span class="badge">{{ cat.name }}</span>
        {% endfor %}
      </div>
    {% endif %}

    <div style="display:flex; gap:1.2rem; flex-wrap:wrap; margin-top: 1rem;">
      {% if book.cover_image %}
        <div>
          <img class="cover-detail" src="{{ book.cover_image }}" alt="{{ book.title }} cover">
        </div>
      {% endif %}

      <div class="meta" style="flex:1; min-width:260px;">
        {% if book.published_year %}<div><strong>Published:</strong> {{ book.published_year }}</div>{% endif %}
        {% if book.price %}<div><strong>Price:</strong> £{{ book.price }}</div>{% endif %}

        <div style="margin-top:.55rem;">
          <strong>Status:</strong>
          {% if book.available %}
            <span class="badge badge-ok">Available for sale or exchange</span>
          {% else %}
            <span class="badge badge-bad">Currently unavailable</span>
          {% endif %}
        </div>
      </div>
    </div>

    {% if book.description %}
      <hr class="sep">
      <h3 style="margin:.2rem 0 .5rem;">Description</h3>
      <p class="meta">{{ book.description }}</p>
    {% endif %}

    <div class="hero-actions" style="margin-top: 1rem;">
      <a class="btn" href="{% url 'book_list' %}">← Back to all books</a>
    </div>
  </div>

  <div class="section">
    <h3>Enquire about this book</h3>

    {% if success %}
      <div class="success">
        Thank you for your enquiry. We’ll get back to you shortly.
      </div>
    {% endif %}

    <div class="form-card">
      <form method="post">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <div class="form-grid">
          <div class="field">
            {{ form.name.label_tag }}
            {{ form.name }}
            {{ form.name.errors }}
          </div>

          <div class="field">
            {{ form.email.label_tag }}
            {{ form.email }}
            {{ form.email.errors }}
          </div>
        </div>

        <div class="field" style="margin-top:.9rem;">
          {{ form.inquiry_type.label_tag }}
          
          <div class="choice-group">
            {{ form.inquiry_type }}
          </div>
          {{ form.inquiry_type.errors }}
           
        <!-- <div class="choice-group">
        {{ form.inquiry_type }}
        </div>
        {{ form.inquiry_type.errors }}
        </div> -->
        

        <div class="field" style="margin-top:.9rem;">
          {{ form.message.label_tag }}
          {{ form.message }}
          {{ form.message.errors }}
        </div>

        <div style="margin-top: 1rem;">
          <button class="btn btn-primary" type="submit">Send enquiry</button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
